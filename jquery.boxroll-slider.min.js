/*!
 * jQuery Box roll slider
 * http://completebaltics.com/blog/jquery-roll-slider/
 * 
 * Copyright (c) 2014 Complete Baltics ltd. Kasparas Skripkauskas
 * Dual licensed under the MIT and GPL licenses.
 */

// About: Examples
// 
// The working example
// Basic example     - http://completebaltics.com/www/boxroll-slider/
// 
// Usage example:
// Add the javascript file jquery.boxroll-slider.js or jquery.boxroll-slider.min.js to your html documents <HEAD>
// Add the css file jquery.boxroll-slider.css to your documents <HEAD>
// 
// Use this code with your own selector to initialize the plugin
// $('#slide-container').boxRollSlider({
//  items: '.items', - default is the containers children
//  timer: 7000, - interval to change slides default is 2000ms
// });
// 
// If height has changed you can also update the slider by calling this function
// $('#slide-container').boxRollSlider('update');
// 
// jQuery Versions - 1.8+
// 
// if css animations are not supported the plugin degrades to javascript crossfade
// 

(function(e){e.fn.boxRollSlider=function(t){function h(){if(c){r.eq(o).css({transform:"rotateX(90deg) translate3d( 0px, "+ -i+"px, "+i+"px )","z-index":0,opacity:0}).on(s,function(){e(this).unbind(s).css({transform:"rotateX(-90deg) translate3d( 0px, "+i+"px, "+i+"px )","z-index":-1,opacity:1,visibility:"hidden"})})}else{r.eq(o).css({"z-index":0,visibility:"visible"})}if(o<u){o++}else{o=0}if(c){r.eq(o).css({transform:"rotateX(0deg) translate3d( 0px, 0px, 0px )",visibility:"visible"}).on(s,function(){e(this).unbind(s).css({"z-index":1})})}else{r.eq(o).css({"z-index":1,visibility:"visible",opacity:0}).animate({opacity:1},1e3)}}function p(){var e=n.container.find(".boxroll-slider-item");i=Math.round(e.height()/2);e.each(function(){r.eq(o-1).css({transform:"rotateX(90deg) translate3d( 0px, "+ -i+"px, "+i+"px )"});r.eq(o).css({transform:"rotateX(0deg) translate3d( 0px, 0px, 0px )"});r.not(":eq("+o+"), :eq("+(o-1)+")").css({transform:"rotateX(-90deg) translate3d( 0px, "+i+"px, "+i+"px )"})})}if(t==="update"&&e(this).hasClass("boxroll-slider")){p()}var n={container:e(this),items:e(this).children(),timer:2e3};e.extend(n,t);var r=n.container.find(n.items);var i=Math.round(n.container.height()/2);var s="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend";var o=0;var u=r.length-1;var a;var f=document.body||document.documentElement,l=f.style,c=l.transition!==undefined||l.WebkitTransition!==undefined||l.MozTransition!==undefined||l.MsTransition!==undefined||l.OTransition!==undefined;n.container.addClass("boxroll-slider");r.addClass("boxroll-slider-item").css("transform","rotateX(-90deg) translate3d( 0px, "+i+"px, "+i+"px )");r.eq(o).css({transform:"rotateX(0deg) translate3d( 0px, 0px, 0px )",opacity:1,"z-index":1,visibility:"visible"});a=window.setInterval(function(){h()},n.timer);e(window).resize(function(){p()});e(document).ready(function(){e(window).on("focus",function(){a=window.setInterval(function(){h()},n.timer)}).on("blur",function(){window.clearInterval(a)})});return e(this)}})(jQuery)
